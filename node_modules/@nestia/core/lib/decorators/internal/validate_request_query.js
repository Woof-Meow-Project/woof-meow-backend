"use strict";
var __importDefault = (this && this.__importDefault) || function (mod) {
    return (mod && mod.__esModule) ? mod : { "default": mod };
};
Object.defineProperty(exports, "__esModule", { value: true });
exports.validate_request_query = void 0;
var common_1 = require("@nestjs/common");
var typia_1 = __importDefault(require("typia"));
var NoTransformConfigureError_1 = require("./NoTransformConfigureError");
var validate_request_query = function (validator) {
    if (!validator)
        return function () { return (0, NoTransformConfigureError_1.NoTransformConfigureError)("TypedQuery"); };
    else if (validator.type === "assert")
        return assert(validator.assert);
    else if (validator.type === "is")
        return is(validator.is);
    else if (validator.type === "validate")
        return validate(validator.validate);
    return function () {
        return new Error("Error on nestia.core.TypedQuery(): invalid typed validator.");
    };
};
exports.validate_request_query = validate_request_query;
var assert = function (closure) {
    return function (input) {
        try {
            return closure(input);
        }
        catch (exp) {
            if ((function (input) {
                var $io0 = function (input) { return "string" === typeof input.method && (undefined === input.path || "string" === typeof input.path) && "string" === typeof input.expected && true && "string" === typeof input.name && "string" === typeof input.message && (undefined === input.stack || "string" === typeof input.stack); };
                return "object" === typeof input && null !== input && $io0(input);
            })(exp)) {
                return new common_1.BadRequestException({
                    path: exp.path,
                    reason: exp.message,
                    expected: exp.expected,
                    value: exp.value,
                    message: MESSAGE,
                });
            }
            throw exp;
        }
    };
};
var is = function (closure) {
    return function (input) {
        var result = closure(input);
        return result !== null ? result : new common_1.BadRequestException(MESSAGE);
    };
};
var validate = function (closure) {
    return function (input) {
        var result = closure(input);
        return result.success
            ? result.data
            : new common_1.BadRequestException({
                errors: result.errors,
                message: MESSAGE,
            });
    };
};
var MESSAGE = "Request query data is not following the promised type.";
//# sourceMappingURL=validate_request_query.js.map